:root{
  --bg:#fff;--ink:#0f172a;--muted:#6b7280;--line:#e5e7eb;
  --brand:#e11d48;--brand-ink:#7f1029;--chip:#f9fafb;
  --safe-b:env(safe-area-inset-bottom,0);--tabbar-h:64px;
  /* category tints */
  --logic:#8b5cf6;--logic-bg:rgba(139,92,246,.07);
  --loops:#14b8a6;--loops-bg:rgba(20,184,166,.07);
  --math:#3b82f6;--math-bg:rgba(59,130,246,.07);
  --text:#f43f5e;--text-bg:rgba(244,63,94,.07);
  --lists:#f59e0b;--lists-bg:rgba(245,158,11,.07);
  --vars:#64748b;--vars-bg:rgba(100,116,139,.07);
  --func:#6366f1;--func-bg:rgba(99,102,241,.07);
  --easy:#16a34a;--easy-bg:#ecfdf5;--medium:#f59e0b;--medium-bg:#fffbeb;--hard:#ef4444;--hard-bg:#fef2f2;
}

/* Base */
html, body { height: 100%; }
body{
  min-height: 100svh;           /* safe viewport units for mobile */
  display: flex;
  flex-direction: column;
}

/* Your main content should expand, pushing the footer down */
main{ flex: 1 0 auto; }

/* Footer (tabbar): sticky when content is taller; bottom when shorter */
.tabbar{
  margin-top: auto;             /* pushes it to the bottom on short pages */
  position: sticky;
  bottom: 0;
  z-index: 1020;
}
a{color:var(--brand)}a:hover{color:#c40e38}
:focus-visible{outline:3px solid #fda4af;outline-offset:3px}

/* Headers */
.navbar{background:#fff;border-bottom:1px solid var(--line)}
.navbar .navbar-brand{font-weight:800}
.appbar{display:none}
@media (max-width:576px){
  .navbar{display:none}
  .appbar{display:block;position:sticky;top:0;z-index:1030;background:#fff;border-bottom:1px solid var(--line)}
  .appbar .brand{font-weight:900}
}

/* Panels / cards */
.panel{background:#fff;border:1px solid #f1f5f9;border-radius:16px;box-shadow:0 8px 18px rgba(2,6,23,.04)}
.panel-title{color:var(--brand-ink);font-weight:800}
.muted,.text-muted{color:var(--muted)!important}

/* Buttons */
.btn-brand{background:var(--brand);border-color:var(--brand);color:#fff;font-weight:800}
.btn-brand:hover{background:#d70f3d;border-color:#d70f3d}
.btn-ghost{border:1px solid var(--line);background:#fff;color:#1f2937}
.btn-ghost:hover{background:#f9fafb}

/* Hero (home) */
.hero{
  background:
    radial-gradient(110% 70% at 95% -10%, #ffe3e8 0, transparent 60%),
    radial-gradient(90% 70% at 0% 0%, #ffedd5 0, transparent 55%),
    linear-gradient(180deg,#fff 0,#fff7f8 100%);
}
.eyebrow{letter-spacing:.14em;text-transform:uppercase;font-weight:800;color:var(--brand)}
.display-title{font-weight:900;line-height:1.04}

/* Feature cards */
.feature.card{border:1px solid #f1f5f9;border-radius:18px;box-shadow:0 8px 18px rgba(2,6,23,.04);transition:transform .18s,box-shadow .18s}
.feature.card:hover{transform:translateY(-2px);box-shadow:0 16px 32px rgba(2,6,23,.07)}
.card-title{color:var(--brand-ink)}
/* ===== FAB: refreshed look ===== */
.fab{
  position: fixed;
  right: 16px;
  bottom: calc(var(--tabbar-h) + 16px + var(--safe-b));
  z-index: 1050;

  /* shape + spacing */
  display: inline-flex;
  align-items: center;
  gap: .55rem;
  padding: .95rem 1.25rem;                 /* bigger, easier to tap */
  border: none;
  border-radius: 999px;                     /* pill on desktop */
  min-height: 52px;

  /* type + icon size */
  font-weight: 800;
  font-size: 1rem;                          /* label size */
  line-height: 1;

  /* 클릭 가능성 확보 */
  cursor: pointer;
  pointer-events: auto;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}
.fab i{
  font-size: 1.25rem;                       /* icon size */
  display: inline-block;
}

/* brand + elevation */
.fab{
  background: linear-gradient(180deg, #ff2b63, var(--brand));
  color: #fff;
  box-shadow:
    0 12px 28px rgba(225, 17, 72, .28),
    0 2px 6px rgba(0,0,0,.08);
}
.fab:hover:not(:disabled){ transform: translateY(-1px); box-shadow:
  0 16px 36px rgba(225, 17, 72, .32),
  0 4px 10px rgba(0,0,0,.10);
}
.fab:active:not(:disabled){ transform: translateY(0); filter: brightness(.96); }
.fab:focus-visible{ outline: 3px solid #fda4af; outline-offset: 3px; }

/* Disabled 상태 스타일 */
.fab:disabled{
  cursor: not-allowed;
  pointer-events: none;
  opacity: 0.6;
}

/* subtle pulse on mount (reduced motion safe) */
@media (prefers-reduced-motion: no-preference){
  .fab{ animation: fab-pop .18s ease-out both; }
  @keyframes fab-pop{ from{ transform: scale(.98); opacity:.0 } to{ transform: scale(1); opacity:1 } }
}

/* Secondary/admin FAB variant */
.fab--secondary{
  background: linear-gradient(180deg, #354154, #0f172a);
  box-shadow:
    0 12px 28px rgba(15, 23, 42, .28),
    0 2px 6px rgba(0,0,0,.08);
}

/* Larger or smaller size modifiers */
.fab--lg{ padding: 1.05rem 1.35rem; min-height: 56px; font-size: 1.05rem; }
.fab--sm{ padding: .75rem .9rem;  min-height: 44px; font-size: .95rem; }
.fab--icon i{ font-size: 1.35rem }         /* emphasize icon when icon-only */

/* Stacking: keep the admin FAB above the run FAB */
.fab-admin{ bottom: calc(var(--tabbar-h) + 16px + var(--safe-b) + 64px); }

/* Mobile: compact, icon-first; hide label to save space */
@media (max-width: 576px){
  .fab{
    padding: .8rem .9rem;                  /* tighter */
    border-radius: 18px;                   /* less pill on tiny screens */
    gap: .45rem;
  }
  .fab .fab-label{ display: none; }        /* icon-only on phones */
  .fab i{ font-size: 1.3rem; }
}

/* High-contrast mode tweaks */
@media (prefers-contrast: more){
  .fab{ box-shadow: 0 0 0 2px rgba(255,255,255,.9), 0 0 0 4px rgba(0,0,0,.2); }
}


/* Sticky bottom tab bar */
.tabbar{background:#fff;border-top:1px solid var(--line);padding:.35rem .75rem calc(.35rem + var(--safe-b));position:sticky;bottom:0;z-index:1020;min-height:var(--tabbar-h)}
.tabbar .tab{flex:1;text-align:center;color:#374151;text-decoration:none;font-size:.82rem}
.tabbar .tab i{display:block;font-size:1.25rem}
.tabbar .tab.active{color:var(--brand)}
.tabbar .label{font-size:.72rem;margin-top:.1rem}

/* Profile bits */
.avatar{width:60px;height:60px;border-radius:16px;background:#fff5f7;border:1px solid #ffe0e7;color:var(--brand);display:flex;align-items:center;justify-content:center;font-weight:900;font-size:1.15rem}
.chip{display:inline-flex;align-items:center;gap:.35rem;padding:.25rem .5rem;background:var(--chip);border:1px solid var(--line);border-radius:999px;font-size:.8rem;color:#1f2937;cursor:default}
.chip i{font-size:1rem}
.chip.cat-logic{background:#ede9fe;border-color:#ddd6fe}
.chip.cat-loops{background:#ecfeff;border-color:#a5f3fc}
.chip.cat-math{background:#eff6ff;border-color:#dbeafe}
.chip.cat-text{background:#ffe4e6;border-color:#fecdd3}
.chip.cat-lists{background:#fef3c7;border-color:#fde68a}
.chip.cat-vars{background:#e2e8f0;border-color:#cbd5e1}
.chip.cat-func{background:#e0e7ff;border-color:#c7d2fe}

/* Inventory block cards */
.block-card{border:1px solid #eef2f7;border-radius:14px;padding:.9rem;display:flex;align-items:center;justify-content:space-between;gap:.75rem;background:#fff}
.block-card .name{font-weight:800}
.block-card .cat-badge{font-size:.75rem;padding:.15rem .5rem;border-radius:999px;border:1px solid #e5e7eb;background:#f8fafc}
.block-card.collected{outline:2px solid #22c55e;background:linear-gradient(90deg,rgba(34,197,94,.1),transparent 50%)}
.block-card.cat-logic{border-left:6px solid var(--logic);background:linear-gradient(90deg,var(--logic-bg),transparent 55%)}
.block-card.cat-loops{border-left:6px solid var(--loops);background:linear-gradient(90deg,var(--loops-bg),transparent 55%)}
.block-card.cat-math{border-left:6px solid var(--math);background:linear-gradient(90deg,var(--math-bg),transparent 55%)}
.block-card.cat-text{border-left:6px solid var(--text);background:linear-gradient(90deg,var(--text-bg),transparent 55%)}
.block-card.cat-lists{border-left:6px solid var(--lists);background:linear-gradient(90deg,var(--lists-bg),transparent 55%)}
.block-card.cat-vars{border-left:6px solid var(--vars);background:linear-gradient(90deg,var(--vars-bg),transparent 55%)}
.block-card.cat-func{border-left:6px solid var(--func);background:linear-gradient(90deg,var(--func-bg),transparent 55%)}

/* Block icon with collected indicator */
.block-icon-container{
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  background: #f8fafc;
  border-radius: 12px;
  border: 1px solid #e5e7eb;
}

.block-icon-container i{
  font-size: 1.2rem;
  color: #64748b;
}

.collected-indicator{
  position: absolute;
  top: -4px;
  right: -4px;
  width: 18px;
  height: 18px;
  background: #22c55e;
  border: 2px solid #fff;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 2px 4px rgba(0,0,0,.1);
}

.collected-indicator i{
  font-size: 0.7rem;
  color: #fff;
}

/* Collected block styling */
.block-card.collected .block-icon-container{
  background: linear-gradient(135deg, #dcfce7, #bbf7d0);
  border-color: #22c55e;
}

.block-card.collected .block-icon-container i{
  color: #16a34a;
}
.progress{height:10px;background:#f1f5f9}
.progress-bar{background:var(--brand)}
.badge-easy{background:var(--easy-bg);color:var(--easy)}
.badge-medium{background:var(--medium-bg);color:var(--medium)}
.badge-hard{background:var(--hard-bg);color:var(--hard)}

/* Challenges page */
.chip[data-tag]{cursor:pointer}
.chip.active{outline:2px solid #fecaca}
.q-card{border:1px solid #eef2f7;border-radius:14px;padding:1rem;display:flex;gap:1rem;background:#fff;align-items:stretch}
.q-card .q-title{font-weight:800}
.q-actions{min-width:210px;display:flex;flex-direction:column;align-items:end;justify-content:center;gap:.5rem}
.q-card.diff-easy{border-left:6px solid var(--easy);background:linear-gradient(90deg,rgba(22,163,74,.06),transparent 55%)}
.q-card.diff-medium{border-left:6px solid var(--medium);background:linear-gradient(90deg,rgba(245,158,11,.07),transparent 55%)}
.q-card.diff-hard{border-left:6px solid var(--hard);background:linear-gradient(90deg,rgba(239,68,68,.07),transparent 55%)}

/* Studio */
.actionbar{position:sticky;top:0;z-index:1020;background:#fff;border-bottom:1px solid var(--line)}
.actionbar .btn{min-width:140px}
@media (max-width:576px){.actionbar .btn{min-width:auto}}
#blocklyArea{position:relative;width:100%;height:540px;background:#fbfcff;border:1px dashed #e5e7eb;border-radius:14px}
#blocklyDiv{position:absolute}
@media (max-width:576px){#blocklyArea{height:420px}}
.console-box,.code-box{min-height:180px;background:#0b1020;color:#e6edf3;border-radius:12px;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
.console-box{padding:12px;white-space:pre-wrap}
.code-box{padding:12px;background:#0e1428}
main{padding-bottom:calc(var(--tabbar-h) + 32px)}

/* Admin */
.nav-pills .nav-link{color:#1f2937;background:#fff;border:1px solid var(--line);font-weight:600;border-radius:999px;margin-right:.35rem}
.nav-pills .nav-link.active{color:#fff;background:var(--brand);border-color:var(--brand)}
.table thead th{position:sticky;top:0;background:#fff;z-index:1}
.code-box.tall{min-height:220px;max-height:60svh;overflow:auto;border:1px solid #0b1020}
.modal.tall .modal-dialog{max-width:min(1080px,96vw);height:min(92svh,100svh);margin:.75rem auto}
.modal.tall .modal-content{height:100%}.modal.tall .modal-body{overflow:auto}

/* Modal fixes - 완전 불투명 강제 적용 */
.modal-backdrop {
  background-color: rgba(0, 0, 0, 0.7) !important;
  opacity: 1 !important;
  backdrop-filter: none !important;
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  width: 100% !important;
  height: 100% !important;
  z-index: 1050 !important;
}

.modal {
  background-color: transparent !important;
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  width: 100% !important;
  height: 100% !important;
  z-index: 1055 !important;
}

.modal.show {
  display: block !important;
  background-color: transparent !important;
}

.modal-dialog {
  background-color: transparent !important;
  position: relative !important;
  width: auto !important;
  margin: 1.75rem auto !important;
  max-width: 500px !important;
}

.modal-content {
  background-color: #ffffff !important;
  background: #ffffff !important;
  border: 3px solid #e5e7eb !important;
  border-radius: 16px !important;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5) !important;
  opacity: 1 !important;
  position: relative !important;
  z-index: 1055 !important;
  display: flex !important;
  flex-direction: column !important;
  width: 100% !important;
  pointer-events: auto !important;
}

.modal-header {
  background-color: #ffffff !important;
  background: #ffffff !important;
  border-bottom: 2px solid #e5e7eb !important;
  border-radius: 16px 16px 0 0 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;
  padding: 1rem !important;
}

.modal-body {
  background-color: #ffffff !important;
  background: #ffffff !important;
  position: relative !important;
  flex: 1 1 auto !important;
  padding: 1rem !important;
}

.modal-footer {
  background-color: #ffffff !important;
  background: #ffffff !important;
  border-top: 2px solid #e5e7eb !important;
  border-radius: 0 0 16px 16px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: flex-end !important;
  padding: 1rem !important;
}

/* 모든 텍스트와 요소 강제 불투명 */
.modal-content *,
.modal-header *,
.modal-body *,
.modal-footer * {
  opacity: 1 !important;
}

/* 특정 요소들에 대한 강제 스타일 */
.modal-title {
  color: #1f2937 !important;
  opacity: 1 !important;
}

.modal-body p,
.modal-body h6,
.modal-body div {
  color: inherit !important;
  opacity: 1 !important;
}

.btn-close {
  opacity: 1 !important;
}

/* Auth forms */
.form-control{border-radius:12px}
.brand-title{font-weight:900;color:var(--brand-ink)}

/* Mobile tweaks */
@media (max-width:576px){
  .display-title{font-size:2rem}
  .lead{font-size:1rem}
  .hero{padding:.75rem 0}
  .cta .btn{width:100%}
}

